<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Rotate Test - Atomic Clock Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .theme-panel {
            position: fixed;
            top: 12px;
            right: 12px;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 8px 10px;
            border-radius: 8px;
            z-index: 1000;
        }
        .auto-rotate-label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 9px;
            cursor: pointer;
        }
        #test-results {
            white-space: pre-wrap;
            font-family: monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Auto-Rotate Functionality Test</h1>
        
        <div class="test-section">
            <h2>Test Controls</h2>
            <button onclick="runFullTest()">üöÄ Run Full Test</button>
            <button onclick="testAutoRotateStart()">‚ñ∂Ô∏è Test Start Auto-Rotate</button>
            <button onclick="testAutoRotateStop()">‚èπÔ∏è Test Stop Auto-Rotate</button>
            <button onclick="testAutoRotateDebug()">üêû Test Debug (5s intervals)</button>
            <button onclick="testThemeCycling()">üîÑ Test Theme Cycling</button>
            <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
        </div>

        <div class="test-section">
            <h2>Theme Panel (for manual testing)</h2>
            <div class="theme-panel">
                <label for="auto-rotate" class="auto-rotate-label">
                    <input type="checkbox" id="auto-rotate" title="Auto-rotate themes every 30 seconds">
                    Auto-rotate
                </label>
            </div>
            <p><small>‚úì Check the box above to start auto-rotate manually</small></p>
        </div>

        <div class="test-section">
            <h2>Test Results</h2>
            <div id="test-results">Click "Run Full Test" to begin testing...</div>
        </div>

        <div class="test-section">
            <h2>Manual Test Instructions</h2>
            <ol>
                <li><strong>Start Auto-Rotate:</strong> Check the "Auto-rotate" checkbox in the theme panel</li>
                <li><strong>Verify Cycling:</strong> Themes should change every 30 seconds</li>
                <li><strong>Check Console:</strong> Open browser console to see auto-rotate logs</li>
                <li><strong>Test Manual Override:</strong> Select a theme manually - auto-rotate should stop</li>
                <li><strong>Test Persistence:</strong> Refresh page - auto-rotate setting should be remembered</li>
            </ol>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="test-auto-rotate.js"></script>
    <script>
        let testOutput = '';

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            testOutput += `[${timestamp}] ${prefix} ${message}\n`;
            document.getElementById('test-results').textContent = testOutput;
        }

        function clearResults() {
            testOutput = '';
            document.getElementById('test-results').textContent = 'Results cleared...';
        }

        function runFullTest() {
            clearResults();
            log('Starting comprehensive auto-rotate test...');
            
            // Test 1: Element existence
            const autoRotateCheckbox = document.getElementById('auto-rotate');
            const styleDropdown = document.getElementById('style-dropdown');
            
            if (autoRotateCheckbox) {
                log('Auto-rotate checkbox found', 'success');
            } else {
                log('Auto-rotate checkbox NOT found', 'error');
                return;
            }

            // Test 2: StatusDisplay class
            if (window.statusDisplay) {
                log('StatusDisplay class found', 'success');
                
                if (typeof window.statusDisplay.startAutoRotate === 'function') {
                    log('startAutoRotate method exists', 'success');
                } else {
                    log('startAutoRotate method NOT found', 'error');
                }
                
                if (typeof window.statusDisplay.stopAutoRotate === 'function') {
                    log('stopAutoRotate method exists', 'success');
                } else {
                    log('stopAutoRotate method NOT found', 'error');
                }
            } else {
                log('StatusDisplay class NOT found', 'error');
                return;
            }

            // Test 3: Auto-rotate start
            setTimeout(() => testAutoRotateStart(), 1000);
        }

        function testAutoRotateStart() {
            log('Testing auto-rotate start...');
            const autoRotateCheckbox = document.getElementById('auto-rotate');
            
            if (autoRotateCheckbox && window.statusDisplay) {
                autoRotateCheckbox.checked = true;
                autoRotateCheckbox.dispatchEvent(new Event('change'));
                
                setTimeout(() => {
                    if (window.statusDisplay.autoRotateInterval !== null) {
                        log('Auto-rotate started successfully', 'success');
                        log('Interval ID: ' + window.statusDisplay.autoRotateInterval);
                    } else {
                        log('Auto-rotate failed to start', 'error');
                    }
                }, 500);
            }
        }

        function testAutoRotateStop() {
            log('Testing auto-rotate stop...');
            const autoRotateCheckbox = document.getElementById('auto-rotate');
            
            if (autoRotateCheckbox && window.statusDisplay) {
                autoRotateCheckbox.checked = false;
                autoRotateCheckbox.dispatchEvent(new Event('change'));
                
                setTimeout(() => {
                    if (window.statusDisplay.autoRotateInterval === null) {
                        log('Auto-rotate stopped successfully', 'success');
                    } else {
                        log('Auto-rotate failed to stop', 'error');
                    }
                }, 500);
            }
        }

        function testAutoRotateDebug() {
            log('Testing DEBUG auto-rotate (5-second intervals)...');
            
            if (window.statusDisplay && typeof window.statusDisplay.startAutoRotateDebug === 'function') {
                // Enable auto-rotate checkbox first
                const autoRotateCheckbox = document.getElementById('auto-rotate');
                if (autoRotateCheckbox) {
                    autoRotateCheckbox.checked = true;
                }
                
                // Start debug auto-rotate
                window.statusDisplay.startAutoRotateDebug();
                log('DEBUG auto-rotate started - watch for theme changes every 5 seconds', 'success');
                log('Check browser console for detailed logs', 'warning');
            } else {
                log('DEBUG auto-rotate function not available', 'error');
            }
        }

        function testThemeCycling() {
            log('Testing theme cycling (will take 30 seconds to observe)...');
            
            if (window.statusDisplay && window.statusDisplay.themes) {
                log(`Themes array has ${window.statusDisplay.themes.length} themes`, 'success');
                log('Themes: ' + window.statusDisplay.themes.join(', '));
                
                // Start auto-rotate to observe cycling
                testAutoRotateStart();
                
                log('Watch for theme changes every 30 seconds...', 'warning');
                log('Check browser console for cycle logs', 'warning');
            } else {
                log('Themes array not found', 'error');
            }
        }

        // Wait for page to load
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('Test page loaded and ready');
                log('Click "Run Full Test" to begin testing auto-rotate functionality');
            }, 1000);
        });
    </script>
</body>
</html>
